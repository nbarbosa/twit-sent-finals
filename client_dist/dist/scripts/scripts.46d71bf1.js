"use strict";angular.module("clientApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngtweet","infinite-scroll"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("clientApp").controller("MainCtrl",["$scope","$http","$rootScope","$timeout","$window",function(a,b,c,d,e){a.tweets=[],c.total=a.tweets.length,a.newTweets=[],a.refresh=function(){for(var b=a.newTweets.length-1;b>=0;b--)console.log(a.newTweets[b]),a.tweets.unshift(a.newTweets[b]);a.newTweets=[]},a.scrollTweets=function(){0!=a.tweets.length&&a.loadTweets()},a.loadStats=function(){b({method:"GET",url:"http://twtsentfinals-server.natabarbosa.com/stats"}).then(function(a){c.positiveCount=a.data.positive,c.negativeCount=a.data.negative},function(a){console.log(a)})},a.loadTweets=function(d,f){d=d||"before";var g="";a.tweets.length>0&&(g="before"==d?a.tweets[a.tweets.length-1].ts_created:0==a.newTweets.length?a.tweets[0].ts_created:a.newTweets[a.newTweets.length-1].ts_created),a.busy=!0,b({method:"GET",url:"http://twtsentfinals-server.natabarbosa.com/tweets?ts="+g+"&when="+d}).then(function(b){for(var g=0;g<b.data.length;g++)"before"==d?a.tweets.push(b.data[g]):0==e.scrollY&&0==a.newTweets.length?a.tweets.unshift(b.data[g]):a.newTweets.push(b.data[g]);a.busy=!1,c.total=a.tweets.length,f()},function(a){console.log(a)})},a.loadTweets(),function f(){a.loadStats(),a.loadTweets("after",function(){d(f,3e3)})}()}]),angular.module("clientApp").run(["$templateCache",function(a){a.put("views/main.html",'<center> <button ng-click="refresh()" ng-show="newTweets.length > 0">Load {{newTweets.length}} new tweet(s)</button> <br> <div infinite-scroll="scrollTweets()" infinite-scroll-disabled="busy" infinite-immediate-check="false"> <div ng-repeat="tweet in tweets" class="tweet-container"> <span class="sentiment positive" ng-show="tweet.sentiment == \'positive\'">ʘ‿ʘ</span> <span class="sentiment negative" ng-show="tweet.sentiment == \'negative\'">ಠ_ಠ</span> <twitter-widget twitter-widget-id="tweet.tweet.id"> </twitter-widget> </div> <!-- <div ng-show=\'busy\'>Loading tweets...</div> --> </div> </center>')}]);